# Список задач по улучшению проекта

## Бонус
- [ ] Заменить жестко закодированные значения переменными в соответствии с лучшими практиками DevOps
  - `server/middleware/userEdit.go`: В коде используются жестко закодированные значения для `Roleid`, `Officeid` и `ID` в `UpdateUserParams`. Их следует заменить переменными.

## S-Tier (Критические проблемы безопасности и стабильности)
- [x] Исправить пул соединений с базой данных - текущая реализация использует глобальную переменную DB и не управляет соединениями должным образом
  - `server/middleware/dbConnect.go`: Код использует `sql.Open` для открытия соединения с базой данных и устанавливает параметры пула соединений с помощью `SetMaxOpenConns`, `SetMaxIdleConns` и `SetConnMaxLifetime`. Это решает проблему пула соединений с базой данных.
- [x] Добавить правильную обработку ошибок при сбоях подключения к базе данных вместо `log.Fatal`
  - `server/middleware/dbConnect.go`: Код включает обработку ошибок при сбоях подключения к базе данных с использованием `db.PingContext` и возвращает ошибку, если соединение не удается. Функция `initDB` возвращает ошибку, которая затем обрабатывается `GetDB`. Это решает проблему обработки ошибок.
- [x] Реализовать безопасное управление сессиями
  - Реализация JWT теперь использует HTTP-only cookies
  - Правильно обрабатывается истечение срока действия токена
  - Реализована очистка cookie при выходе из системы
  - Валидация токена включает правильную обработку ошибок
- [x] Добавить валидацию и очистку входных данных пользователя
  - Реализована проверка формы в компоненте EditUser
  - Добавлена проверка формата электронной почты
  - Добавлена проверка обязательных полей
  - Реализована проверка ролей и офисов
- [x] Добавить защиту CSRF для форм
  - Использование SameSite cookies (Lax mode) для защиты CSRF
  - Валидация токена на всех защищенных конечных точках
- [ ] Переместить переменные среды в безопасную систему управления конфигурацией
  - `server/.env`: Код использует файл `.env` для хранения переменных среды. Это не безопасная система управления конфигурацией.
- [ ] Добавить ограничение скорости для конечных точек аутентификации
  - `server/middleware/register.go`: В коде отсутствует ограничение скорости для конечной точки регистрации.
- [x] Реализовать правильные правила проверки пароля
  - Реализовано хеширование пароля с помощью bcrypt
  - Добавлена проверка сложности пароля при регистрации
- [ ] Добавить систему миграции базы данных для изменений схемы
  - `server/config/database.go`: В коде отсутствует система миграции базы данных.

## A-Tier (Важная функциональность и производительность)
- [x] Реализовать правильную систему ведения журнала с уровнями
  - Добавлено структурированное ведение журнала с отметкой времени, методом, путем, кодом состояния и задержкой
  - Ведение журнала ошибок включено в глобальный обработчик ошибок
- [x] Добавить обработку транзакций базы данных для критических операций
  - Операции с базой данных теперь используют правильный пул соединений
  - Улучшена обработка ошибок для операций с базой данных
- [ ] Реализовать правильное управление версиями API
- [x] Добавить обработку таймаута контекста запроса
  - Добавлен таймаут контекста для операций с базой данных
  - Добавлено корректное завершение работы с таймаутом
- [x] Реализовать правильные ответы об ошибках с согласованным форматом
  - Добавлен компонент ErrorBoundary для ошибок интерфейса
  - Согласованный формат сообщений об ошибках в ответах API
- [ ] Добавить оптимизацию запросов к базе данных и индексацию
- [ ] Реализовать уровень кэширования для часто используемых данных
- [ ] Добавить правильный сбор метрик для мониторинга
- [x] Реализовать правильную очистку устаревших сессий/токенов
  - Реализована проверка срока действия токена
  - Очистка cookie при выходе из системы

## B-Tier (Качество кода и удобство сопровождения)
- [ ] Реструктурировать проект в соответствии со стандартной структурой проекта Go
- [x] Добавить исчерпывающую документацию по API
  - Добавлена подробная документация по API в docs/API.md
  - Документирован поток аутентификации и конечные точки
  - Добавлены соображения безопасности
- [x] Реализовать правильное внедрение зависимостей
  - Удалены глобальные переменные в пользу правильного внедрения зависимостей
  - Добавлены геттеры хранилища для лучшего управления состоянием
- [ ] Добавить модульные тесты для критических компонентов
- [ ] Добавить интеграционные тесты для конечных точек API
- [x] Реализовать правильные абстракции интерфейсов
  - Добавлены правильные интерфейсы компонентов
  - Улучшена абстракция управления состоянием
- [x] Добавить документацию к коду
  - Добавлены комментарии JSDoc
  - Улучшена документация функций
  - Добавлена документация API
- [x] Создать правильные конфигурации разработки
  - Добавлена правильная конфигурация Vite
  - Добавлена конфигурация TailwindCSS
  - Добавлена правильная обработка среды

## C-Tier (Улучшения интерфейса)
- [x] Реализовать правильное управление состоянием
  - Добавлен магазин Vuex с правильными мутациями
  - Добавлены вычисляемые свойства
  - Добавлена правильная типизация состояния
- [x] Добавить правильные состояния загрузки
  - Добавлены индикаторы загрузки
  - Добавлены правильные состояния ошибок
  - Добавлены правильные состояния успеха
- [x] Реализовать правильную обработку ошибок
  - Добавлен компонент ErrorBoundary
  - Добавлены правильные сообщения об ошибках
  - Добавлены потоки восстановления после ошибок
- [x] Добавить проверку формы
  - Добавлена проверка на стороне клиента
  - Добавлены правильные сообщения об ошибках
  - Добавлена обратная связь по валидации
- [x] Улучшить адаптивный дизайн
  - Добавлены адаптивные классы
  - Добавлена правильная мобильная навигация
  - Добавлена правильная разметка формы
- [ ] Добавить правильные типы TypeScript
- [x] Реализовать правильные защиты маршрутов
  - Добавлены охранники аутентификации
  - Добавлены охранники на основе ролей
  - Добавлены правильные перенаправления
- [ ] Добавить прогрессивную загрузку для больших наборов данных

## D-Tier (Пользовательский опыт)
- [x] Добавить правильные сообщения обратной связи
  - Добавлены сообщения об успехе
  - Добавлены сообщения об ошибках
  - Добавлены индикаторы загрузки
- [x] Реализовать правильную обратную связь по валидации формы
  - Добавлена встроенная проверка
  - Добавлена проверка на уровне формы
  - Добавлены правильные состояния ошибок
- [ ] Добавить функцию "Запомнить меня"
- [x] Реализовать правильную навигацию
  - Добавлены правильные охранники навигации
  - Добавлена правильная обработка маршрутов
  - Добавлены правильные ссылки
- [x] Добавить правильную обратную связь по валидации формы
  - Добавлена проверка в реальном времени
  - Добавлены правильные сообщения об ошибках
  - Добавлены правильные состояния успеха
- [x] Реализовать правильные индикаторы загрузки
  - Добавлены скелеты загрузки
  - Добавлены состояния загрузки
  - Добавлены правильные переходы
- [x] Добавить правильные потоки восстановления после ошибок
  - Добавлена граница ошибки
  - Добавлена функция повтора
  - Добавлены правильные сообщения об ошибках
- [x] Реализовать правильные уведомления
  - Добавлены уведомления об успехе
  - Добавлены уведомления об ошибках
  - Добавлено правильное оформление

## E-Tier (Приятные дополнения)
- [x] Добавить поддержку темной темы
  - Добавлен переключатель темной темы
  - Добавлена правильная цветовая схема
  - Добавлены правильные переходы
- [ ] Реализовать многоязыковую поддержку
- [ ] Добавить функцию экспорта данных
- [x] Реализовать хранение пользовательских настроек
  - Добавлено сохранение темной темы
  - Добавлено правильное управление состоянием
- [ ] Добавить сочетания клавиш
- [ ] Реализовать правильные макеты для печати
- [x] Добавить функции специальных возможностей
  - Добавлены метки ARIA
  - Добавлены правильные состояния фокуса
  - Добавлен правильный цветовой контраст
- [ ] Реализовать функцию резервного копирования данных

## F-Tier (Будущие соображения)
- [ ] Добавить поддержку провайдеров OAuth
- [ ] Реализовать обновления в реальном времени с использованием WebSocket
- [ ] Добавить поддержку вложений файлов
- [ ] Реализовать аудит
- [ ] Добавить поддержку различных систем оценок
- [ ] Реализовать автоматическую генерацию отчетов
- [ ] Добавить поддержку интеграции с академическим календарем
- [ ] Реализовать отслеживание посещаемости студентов

## Заметки по адаптации системы оценок студентов
- Текущая концепция "Офис" может быть перепрофилирована для "Департамента" или "Факультета"
- Таблицу "Пользователи" необходимо расширить полями, специфичными для студентов
- Необходимы новые таблицы для:
  - Курсов
  - Заданий
  - Оценок
  - Академических семестров
  - Студенческих групп
  - Записей о посещаемости